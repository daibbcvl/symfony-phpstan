{# templates/example.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Example Page{% endblock %}

{% block content %}
    <div id="message"></div>
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js';
        import { getMessaging, getToken, onMessage } from 'https://www.gstatic.com/firebasejs/10.12.5/firebase-messaging.js';

        // Your Firebase configuration from Twig
        const firebaseConfig = {{ jsonData|raw }};

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const messaging = getMessaging(app);
        console.log(messaging);

        // messaging.requestPermission()
        //     .then(() => {
        //         console.log('Notification permission granted.');
        //         return messaging.getToken();
        //     })
        //     .then((token) => {
        //         console.log('FCM Token:', token);
        //         // Save or send the token to your server if necessary
        //     })
        //     .catch((err) => {
        //         console.error('Unable to get permission for notifications', err);
        //     });
        //
        // // Handle incoming messages
        // messaging.onMessage((payload) => {
        //     console.log('Message received. ', payload);
        //     const token = payload.notification ? payload.notification.token : null;
        //     if (token === 'TOKEN1') {
        //         // Display the notification message
        //         document.getElementById('message').innerText = `New message: ${payload.notification.body}`;
        //     }
        // });

    </script>

    <h1>Welcome to the Example Page</h1>
    <p>This is an example of a page that extends the base template.</p>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <!-- Add additional JavaScript files specific to this page -->
{% endblock %}
